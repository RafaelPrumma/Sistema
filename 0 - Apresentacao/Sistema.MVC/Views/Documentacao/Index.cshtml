@{
    ViewData["Title"] = "Documentação do Sistema";
}

<div class="row">
    <nav class="col-md-3">
        <ul id="doc-nav" class="nav flex-column position-sticky" style="top:1rem">
            <li class="nav-item"><a class="nav-link" href="#login">Login</a></li>
            <li class="nav-item"><a class="nav-link" href="#home">Página inicial</a></li>
            <li class="nav-item"><a class="nav-link" href="#configuracoes">Configurações</a></li>
            <li class="nav-item"><a class="nav-link" href="#tema">Tema</a></li>
            <li class="nav-item"><a class="nav-link" href="#mensagens">Mensagens</a></li>
            <li class="nav-item"><a class="nav-link" href="#scripts">Scripts</a></li>
        </ul>
    </nav>
    <div class="col-md-9">
        <section id="login">
            <h2>Login</h2>
            <p>Informe CPF e senha para acessar o sistema. Há opções de registro e recuperação de senha.</p>
        </section>
        <section id="home">
            <h2>Página inicial</h2>
            <p>Apresenta um painel com o resumo geral após o login.</p>
        </section>
        <section id="configuracoes">
            <h2>Configurações</h2>
            <p>Permite listar, criar e editar configurações agrupadas por tema.</p>
        </section>
        <section id="tema">
            <h2>Tema</h2>
            <p>Personalize cores, modo escuro e disposição do layout.</p>
        </section>
        <section id="mensagens">
            <h2>Mensagens</h2>
            <p>O módulo de mensagens permite conversas diretas ou com todo um setor, mantendo o histórico encadeado.</p>
            <ul>
                <li><strong>Caixa de entrada e saída:</strong> listagem paginada com filtros por remetente, palavra-chave e intervalo de datas.</li>
                <li><strong>Envio:</strong> escolha um destinatário individual ou selecione um setor/perfil para enviar a mesma mensagem a todos os integrantes.</li>
                <li><strong>Threads:</strong> respostas ficam agrupadas à mensagem original, exibindo todo o histórico da conversa em formato de thread.</li>
                <li><strong>Conversa completa:</strong> ao abrir um item, mostramos a cadeia de mensagens relacionadas que envolvem o usuário.</li>
                <li><strong>Leitura:</strong> mensagens destinadas ao usuário são marcadas como lidas ao serem abertas, mantendo o contador atualizado.</li>
                <li><strong>Detalhes do remetente/destinatário:</strong> os nomes de quem enviou e de quem recebeu são sempre exibidos em cada linha.</li>
            </ul>
            <p>Para responder, use o botão de resposta na própria thread. O sistema preserva o contexto, garantindo que cada réplica apareça logo abaixo da anterior.</p>
        </section>
        <section id="scripts">
            <h2>Scripts e interações</h2>
            <p>A manipulação do tema, menus e outros elementos utiliza jQuery para facilitar o controle do DOM.</p>
        </section>
    </div>
</div>

@section Scripts {
    <script>
        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    document.querySelectorAll('#doc-nav .nav-link').forEach(l => l.classList.remove('active'));
                    const id = entry.target.getAttribute('id');
                    document.querySelector(`#doc-nav .nav-link[href="#${id}"]`).classList.add('active');
                }
            });
        }, { rootMargin: '-50% 0px -50% 0px' });

        document.querySelectorAll('section').forEach(sec => observer.observe(sec));
    </script>
}
